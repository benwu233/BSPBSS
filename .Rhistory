res_sum2 = sum_mcmc_bspbss(res2, degree_weighted, ini$kernel, start = 1, end = 20, select_p = 0.8)
out = res_sum2$Slist[[20]]
savepath = "/Users/ben/Desktop/work2/GaussianProcess/real_thin/5_nf1000/"
file0 = paste0(savepath ,'test500_10_ini')
output_nii(out,nii,coord,mask1>0,file0,std=TRUE)
out = res_sum2$S
savepath = "/Users/ben/Desktop/work2/GaussianProcess/real_thin/5_nf1000/"
file0 = paste0(savepath ,'test500_10_ini')
output_nii(out,nii,coord,mask1>0,file0,std=TRUE)
res_sum3 = readRDS("/Users/ben/Desktop/work2/GaussianProcess/real_thin/5_nf1000/res_sum2k_0k_t10_0.5_1_.rds")
out = res_sum3$Slist[[200]]
file0 = paste0(savepath ,'testS_200')
output_nii(out,nii,coord,mask1>0,file0,std=TRUE)
plot(res_sum2$loglik)
plot(res_sum3$loglik)
max(res_sum3$loglik)
max(res_sum2$loglik)
out = res_sum3$Slist[[50]]
file0 = paste0(savepath ,'testS_50')
output_nii(out,nii,coord,mask1>0,file0,std=TRUE)
res_sum3 = readRDS("/Users/ben/Desktop/work2/GaussianProcess/real_thin/5_nf1000/res_sum12k_2k_t10_0.5_1_.rds")
length(res_sum3$Slist)
out = res_sum3$S
file0 = paste0(savepath ,'testS')
output_nii(out,nii,coord,mask1>0,file0,std=TRUE)
out = res_sum3$Slist[[1000]]
file0 = paste0(savepath ,'testS_1000')
output_nii(out,nii,coord,mask1>0,file0,std=TRUE)
out = res_sum3$Slist[[500]]
file0 = paste0(savepath ,'testS_500')
output_nii(out,nii,coord,mask1>0,file0,std=TRUE)
out = res_sum3$Slist[[800]]
file0 = paste0(savepath ,'testS_800')
output_nii(out,nii,coord,mask1>0,file0,std=TRUE)
out = res_sum3$Slist[[300]]
file0 = paste0(savepath ,'testS_300')
output_nii(out,nii,coord,mask1>0,file0,std=TRUE)
out = res_sum3$Slist[[900]]
file0 = paste0(savepath ,'testS_900')
output_nii(out,nii,coord,mask1>0,file0,std=TRUE)
plot(res_sum2$loglik)
plot(res_sum3$loglik)
ini = readRDS("/Users/ben/Desktop/work2/GaussianProcess/real_thin/5_nf1000/ini_b500_n500.rds")
dim(ini$init$A)
MClength = 1000
burn_in = 0
show_step = 1
thin0 = 10
res = mcmc_bspbss(degree_weighted,ini$init,ini$prior,ini$kernel,0.5,lr= 1,subsample_n = 0.05, subsample_p = 0.005, MClength,burn_in,thin0,show_step)
ini = readRDS("/Users/ben/Desktop/work2/GaussianProcess/real_thin/5_nf1000/ini_b1000_n500.rds")
set.seed(2333)
ini = init_bspbss( degree_weighted, mask = (mask1>0), xgrid = coord, dens = 0.5, q = 10, ker_par = c(0.001,500),num_eigen = 500, noise = 0.00 )
saveRDS(ini ,"/Users/ben/Desktop/work2/GaussianProcess/real_thin/5_nf1000/ini_a001b500_n500.rds")
ini = readRDS("/Users/ben/Desktop/work2/GaussianProcess/real_thin/5_nf1000/ini_a001b500_n500.rds")
MClength = 1000
burn_in = 0
show_step = 10
thin0 = 10
res = mcmc_bspbss(degree_weighted,ini$init,ini$prior,ini$kernel,0.5,lr= 1,subsample_n = 0.05, subsample_p = 0.005, MClength,burn_in,thin0,show_step)
res_sum2 = sum_mcmc_bspbss(res2, degree_weighted, ini$kernel, start = 1, end = 100, select_p = 0.8)
res_sum2 = sum_mcmc_bspbss(res, degree_weighted, ini$kernel, start = 1, end = 100, select_p = 0.8)
out = res_sum2$Slist[[100]]
savepath = "/Users/ben/Desktop/work2/GaussianProcess/real_thin/5_nf1000/"
file0 = paste0(savepath ,'test500_10_ini')
output_nii(out,nii,coord,mask1>0,file0,std=TRUE)
out = res_sum2$Slist[[50]]
savepath = "/Users/ben/Desktop/work2/GaussianProcess/real_thin/5_nf1000/"
file0 = paste0(savepath ,'test500_10_ini')
output_nii(out,nii,coord,mask1>0,file0,std=TRUE)
set.seed(2333)
ini = init_bspbss( degree_weighted, mask = (mask1>0), xgrid = coord, dens = 0.5, q = 10, ker_par = c(0.05,500),num_eigen = 500, noise = 0.00 )
saveRDS(ini ,"/Users/ben/Desktop/work2/GaussianProcess/real_thin/5_nf1000/ini_a05b500_n500.rds")
ini = readRDS("/Users/ben/Desktop/work2/GaussianProcess/real_thin/5_nf1000/ini_a05b500_n500.rds")
MClength = 500
burn_in = 0
show_step = 10
thin0 = 10
res = mcmc_bspbss(degree_weighted,ini$init,ini$prior,ini$kernel,0.5,lr= 1,subsample_n = 0.05, subsample_p = 0.005, MClength,burn_in,thin0,show_step)
res_sum2 = sum_mcmc_bspbss(res, degree_weighted, ini$kernel, start = 1, end = 50, select_p = 0.8)
out = res_sum2$Slist[[50]]
savepath = "/Users/ben/Desktop/work2/GaussianProcess/real_thin/5_nf1000/"
file0 = paste0(savepath ,'test500_10_ini')
output_nii(out,nii,coord,mask1>0,file0,std=TRUE)
res2 =  mcmc_bspbss_pickup(degree_weighted,res,ini$prior,ini$kernel,0.5,lr= 1,subsample_n = 0.05, subsample_p = 0.005, MClength,burn_in,thin0,show_step,noise = 0.0)
res_sum2 = sum_mcmc_bspbss(res2, degree_weighted, ini$kernel, start = 1, end = 50, select_p = 0.8)
out = res_sum2$Slist[[50]]
savepath = "/Users/ben/Desktop/work2/GaussianProcess/real_thin/5_nf1000/"
file0 = paste0(savepath ,'test500_10_ini')
output_nii(out,nii,coord,mask1>0,file0,std=TRUE)
ini = readRDS("/Users/ben/Desktop/work2/GaussianProcess/real_thin/5_nf1000/ini_a05b500_n500.rds")
MClength = 500
burn_in = 0
show_step = 10
thin0 = 10
res = mcmc_bspbss(degree_weighted,ini$init,ini$prior,ini$kernel,0.5,lr= 2,subsample_n = 0.05, subsample_p = 0.005, MClength,burn_in,thin0,show_step)
res_sum2 = sum_mcmc_bspbss(res, degree_weighted, ini$kernel, start = 1, end = 50, select_p = 0.8)
plot(res_sum2$loglik)
out = res_sum2$Slist[[50]]
savepath = "/Users/ben/Desktop/work2/GaussianProcess/real_thin/5_nf1000/"
file0 = paste0(savepath ,'test500_10_ini')
output_nii(out,nii,coord,mask1>0,file0,std=TRUE)
res2 =  mcmc_bspbss_pickup(degree_weighted,res,ini$prior,ini$kernel,0.5,lr= 2,subsample_n = 0.05, subsample_p = 0.005, MClength,burn_in,thin0,show_step,noise = 0.0)
res_sum2 = sum_mcmc_bspbss(res2, degree_weighted, ini$kernel, start = 1, end = 50, select_p = 0.8)
plot(res_sum2)
plot(res_sum2$loglik)
effectiveSize(res_sum2$loglik)
out = res_sum2$Slist[[50]]
savepath = "/Users/ben/Desktop/work2/GaussianProcess/real_thin/5_nf1000/"
file0 = paste0(savepath ,'test500_11_ini')
output_nii(out,nii,coord,mask1>0,file0,std=TRUE)
res_sum3 = readRDS("/Users/ben/Desktop/work2/GaussianProcess/real_thin/5_nf1000/res_sum22k_12k_t10_0.5_1_.rds")
effectiveSize(res_sum3$loglik)
plot(res_sum3$loglik)
out = res_sum3$S
file0 = paste0(savepath ,'testS')
output_nii(out,nii,coord,mask1>0,file0,std=TRUE)
out = res_sum3$Slist[[1000]]
file0 = paste0(savepath ,'testS_1000')
output_nii(out,nii,coord,mask1>0,file0,std=TRUE)
out = res_sum3$Slist[[500]]
file0 = paste0(savepath ,'testS_500')
output_nii(out,nii,coord,mask1>0,file0,std=TRUE)
set.seed(2333)
ini = init_bspbss( degree_weighted, mask = (mask1>0), xgrid = coord, dens = 0.5, q = 10, ker_par = c(0.05,1000),num_eigen = 500, noise = 0.00 )
saveRDS(ini ,"/Users/ben/Desktop/work2/GaussianProcess/real_thin/5_nf1000/ini_a05b1000_n500.rds")
ini = readRDS("/Users/ben/Desktop/work2/GaussianProcess/real_thin/5_nf1000/ini_a05b1000_n500.rds")
MClength = 500
burn_in = 0
show_step = 10
thin0 = 10
res = mcmc_bspbss(degree_weighted,ini$init,ini$prior,ini$kernel,0.5,lr= 1,subsample_n = 0.05, subsample_p = 0.005, MClength,burn_in,thin0,show_step)
res_sum2 = sum_mcmc_bspbss(res, degree_weighted, ini$kernel, start = 1, end = 50, select_p = 0.8)
out = res_sum2$Slist[[50]]
savepath = "/Users/ben/Desktop/work2/GaussianProcess/real_thin/5_nf1000/"
file0 = paste0(savepath ,'test500_11_ini')
output_nii(out,nii,coord,mask1>0,file0,std=TRUE)
res2 =  mcmc_bspbss_pickup(degree_weighted,res,ini$prior,ini$kernel,0.5,lr= 1,subsample_n = 0.05, subsample_p = 0.005, MClength,burn_in,thin0,show_step,noise = 0.0)
res_sum2 = sum_mcmc_bspbss(res2, degree_weighted, ini$kernel, start = 1, end = 50, select_p = 0.8)
out = res_sum2$Slist[[50]]
savepath = "/Users/ben/Desktop/work2/GaussianProcess/real_thin/5_nf1000/"
file0 = paste0(savepath ,'test500_11_ini')
output_nii(out,nii,coord,mask1>0,file0,std=TRUE)
out = res_sum2$S
savepath = "/Users/ben/Desktop/work2/GaussianProcess/real_thin/5_nf1000/"
file0 = paste0(savepath ,'test500_11_ini')
output_nii(out,nii,coord,mask1>0,file0,std=TRUE)
Agp = res_sum2$A[,2]
A1 = Agp[phenotype$DX_GROUP==1] #patient
A2 = Agp[phenotype$DX_GROUP==2] #controls
tmp = t.test(log(-A1),log(-A2) )
tmp$p.value
tmp = wilcox.test(Agp~phenotype$DX_GROUP)
tmp$p.value
plot(res_sum2$loglik)
set.seed(2333)
ini = init_bspbss( degree_weighted, mask = (mask1>0), xgrid = coord, dens = 0.5, q = 10, ker_par = c(0.05,500),num_eigen = 800, noise = 0.00 )
saveRDS(ini ,"/Users/ben/Desktop/work2/GaussianProcess/real_thin/5_nf1000/ini_a05b500_n800.rds")
ini = readRDS("/Users/ben/Desktop/work2/GaussianProcess/real_thin/5_nf1000/ini_a05b500_n800.rds")
MClength = 500
burn_in = 0
show_step = 10
thin0 = 10
res = mcmc_bspbss(degree_weighted,ini$init,ini$prior,ini$kernel,0.5,lr= 1,subsample_n = 0.05, subsample_p = 0.005, MClength,burn_in,thin0,show_step)
res_sum2 = sum_mcmc_bspbss(res, degree_weighted, ini$kernel, start = 1, end = 50, select_p = 0.8)
out = res_sum2$Slist[[50]]
savepath = "/Users/ben/Desktop/work2/GaussianProcess/real_thin/5_nf1000/"
file0 = paste0(savepath ,'test500_11_ini')
output_nii(out,nii,coord,mask1>0,file0,std=TRUE)
MClength = 500
burn_in = 0
show_step = 10
thin0 = 10
res = mcmc_bspbss(degree_weighted,ini$init,ini$prior,ini$kernel,0.5,lr= 0.5,subsample_n = 0.05, subsample_p = 0.005, MClength,burn_in,thin0,show_step)
res_sum2 = sum_mcmc_bspbss(res, degree_weighted, ini$kernel, start = 1, end = 50, select_p = 0.8)
out = res_sum2$Slist[[50]]
savepath = "/Users/ben/Desktop/work2/GaussianProcess/real_thin/5_nf1000/"
file0 = paste0(savepath ,'test500_11_ini')
output_nii(out,nii,coord,mask1>0,file0,std=TRUE)
plot(res_sum2$loglik)
max(res_sum2$loglik)
res2 =  mcmc_bspbss_pickup(degree_weighted,res,ini$prior,ini$kernel,0.5,lr= 0.5,subsample_n = 0.05, subsample_p = 0.005, MClength,burn_in,thin0,show_step,noise = 0.0)
res_sum2 = sum_mcmc_bspbss(res2, degree_weighted, ini$kernel, start = 1, end = 50, select_p = 0.8)
out = res_sum2$Slist[[50]]
savepath = "/Users/ben/Desktop/work2/GaussianProcess/real_thin/5_nf1000/"
file0 = paste0(savepath ,'test500_11_ini')
output_nii(out,nii,coord,mask1>0,file0,std=TRUE)
plot(res$b[1,1,])
plot(res$b[2,1,])
plot(res2$b[2,1,])
ini = readRDS("/Users/ben/Desktop/work2/GaussianProcess/real_thin/5_nf1000/ini_a05b500_n800.rds")
MClength = 500
burn_in = 0
show_step = 10
thin0 = 10
res = mcmc_bspbss(degree_weighted,ini$init,ini$prior,ini$kernel,0.2,lr= 0.5,subsample_n = 0.05, subsample_p = 0.005, MClength,burn_in,thin0,show_step)
ini = readRDS("/Users/ben/Desktop/work2/GaussianProcess/real_thin/5_nf1000/ini_a05b500_n800.rds")
ini = readRDS("/Users/ben/Desktop/work2/GaussianProcess/real_thin/5_nf1000/ini_a05b500_n800.rds")
MClength = 400
burn_in = 0
show_step = 10
thin0 = 10
res = mcmc_bspbss(degree_weighted,ini$init,ini$prior,ini$kernel,0.2,lr= 0.8,subsample_n = 0.05, subsample_p = 0.005, MClength,burn_in,thin0,show_step)
res_sum2 = sum_mcmc_bspbss(res, degree_weighted, ini$kernel, start = 1, end = 40, select_p = 0.8)
out = res_sum2$Slist[[40]]
savepath = "/Users/ben/Desktop/work2/GaussianProcess/real_thin/5_nf1000/"
file0 = paste0(savepath ,'test500_11_ini')
output_nii(out,nii,coord,mask1>0,file0,std=TRUE)
ini = readRDS("/Users/ben/Desktop/work2/GaussianProcess/real_thin/5_nf1000/ini_a05b500_n800.rds")
MClength = 400
burn_in = 0
show_step = 10
thin0 = 10
res = mcmc_bspbss(degree_weighted,ini$init,ini$prior,ini$kernel,0.2,lr= 0.3,subsample_n = 0.05, subsample_p = 0.005, MClength,burn_in,thin0,show_step)
res_sum3 = readRDS("/Users/ben/Desktop/work2/GaussianProcess/real_thin/5_nf1000/res_sum12k_2k_t10_0.5_1_.rds")
out = res_sum3$S
file0 = paste0(savepath ,'testS')
output_nii(out,nii,coord,mask1>0,file0,std=TRUE)
set.seed(2333)
ini = init_bspbss( degree_weighted, mask = (mask1>0), xgrid = coord, dens = 0.5, q = 10, ker_par = c(0.02,500),num_eigen = 600, noise = 0.00 )
saveRDS(ini ,"/Users/ben/Desktop/work2/GaussianProcess/real_thin/5_nf1000/ini_a02b500_n600.rds")
ini = readRDS("/Users/ben/Desktop/work2/GaussianProcess/real_thin/5_nf1000/ini_a02b500_n600.rds")
MClength = 400
burn_in = 0
show_step = 10
thin0 = 10
res = mcmc_bspbss(degree_weighted,ini$init,ini$prior,ini$kernel,0.5,lr= 0.5,subsample_n = 0.05, subsample_p = 0.005, MClength,burn_in,thin0,show_step)
res_sum2 = sum_mcmc_bspbss(res, degree_weighted, ini$kernel, start = 1, end = 40, select_p = 0.8)
out = res_sum2$Slist[[40]]
savepath = "/Users/ben/Desktop/work2/GaussianProcess/real_thin/5_nf1000/"
file0 = paste0(savepath ,'test500_11_ini')
output_nii(out,nii,coord,mask1>0,file0,std=TRUE)
res_sum3 = readRDS("/Users/ben/Desktop/work2/GaussianProcess/real_thin/5_nf1000/res_sum2k_0k_t10_0.5_1_.rds")
out = res_sum3$Slist[[200]]
out = res_sum3$S
file0 = paste0(savepath ,'testS_200')
output_nii(out,nii,coord,mask1>0,file0,std=TRUE)
out = res_sum3$Slist[[100]]
file0 = paste0(savepath ,'testS_100')
output_nii(out,nii,coord,mask1>0,file0,std=TRUE)
ini = init_bspbss( degree_weighted, mask = (mask1>0), xgrid = coord, dens = 0.5, q = 10, ker_par = c(0.05,500),num_eigen = 600, noise = 0.00 )
saveRDS(ini ,"/Users/ben/Desktop/work2/GaussianProcess/real_thin/5_nf1000/ini_a05b500_n600.rds")
ini = readRDS("/Users/ben/Desktop/work2/GaussianProcess/real_thin/5_nf1000/ini_a05b500_n600.rds")
MClength = 500
burn_in = 0
show_step = 10
thin0 = 10
res = mcmc_bspbss(degree_weighted,ini$init,ini$prior,ini$kernel,0.5,lr= 0.5,subsample_n = 0.05, subsample_p = 0.005, MClength,burn_in,thin0,show_step)
res_sum2 = sum_mcmc_bspbss(res, degree_weighted, ini$kernel, start = 1, end = 50, select_p = 0.8)
out = res_sum2$Slist[[40]]
savepath = "/Users/ben/Desktop/work2/GaussianProcess/real_thin/5_nf1000/"
file0 = paste0(savepath ,'test500_11_ini')
output_nii(out,nii,coord,mask1>0,file0,std=TRUE)
out = res_sum2$Slist[[50]]
savepath = "/Users/ben/Desktop/work2/GaussianProcess/real_thin/5_nf1000/"
file0 = paste0(savepath ,'test500_11_ini')
output_nii(out,nii,coord,mask1>0,file0,std=TRUE)
ini = init_bspbss( degree_weighted, mask = (mask1>0), xgrid = coord, dens = 0.5, q = 15, ker_par = c(0.05,500),num_eigen = 600, noise = 0.00 )
saveRDS(ini ,"/Users/ben/Desktop/work2/GaussianProcess/real_thin/5_nf1000/ini_a05b500_n600_q15.rds")
ini = readRDS("/Users/ben/Desktop/work2/GaussianProcess/real_thin/5_nf1000/ini_a05b500_n600_q15.rds")
MClength = 500
burn_in = 0
show_step = 10
thin0 = 10
res = mcmc_bspbss(degree_weighted,ini$init,ini$prior,ini$kernel,0.5,lr= 0.5,subsample_n = 0.05, subsample_p = 0.005, MClength,burn_in,thin0,show_step)
MClength = 500
burn_in = 0
show_step = 10
thin0 = 10
res = mcmc_bspbss(degree_weighted,ini$init,ini$prior,ini$kernel,0.5,lr= 0.5,subsample_n = 0.05, subsample_p = 0.005, MClength,burn_in,thin0,show_step)
ini = readRDS("/Users/ben/Desktop/work2/GaussianProcess/real_thin/5_nf1000/ini_a05b500_n600_q15.rds")
MClength = 500
burn_in = 0
show_step = 10
thin0 = 10
res = mcmc_bspbss(degree_weighted,ini$init,ini$prior,ini$kernel,0.5,lr= 0.5,subsample_n = 0.05, subsample_p = 0.005, MClength,burn_in,thin0,show_step)
res_sum2 = sum_mcmc_bspbss(res, degree_weighted, ini$kernel, start = 1, end = 50, select_p = 0.8)
out = res_sum2$Slist[[50]]
savepath = "/Users/ben/Desktop/work2/GaussianProcess/real_thin/5_nf1000/"
file0 = paste0(savepath ,'test500_11_ini')
output_nii(out,nii,coord,mask1>0,file0,std=TRUE)
ini = readRDS("/Users/ben/Desktop/work2/GaussianProcess/real_thin/5_nf1000/ini_a05b500_n600_q15.rds")
MClength = 2000
burn_in = 0
show_step = 10
thin0 = 10
res = mcmc_bspbss(degree_weighted,ini$init,ini$prior,ini$kernel,0.5,lr= 0.5,subsample_n = 0.05, subsample_p = 0.005, MClength,burn_in,thin0,show_step)
res_sum2 = sum_mcmc_bspbss(res, degree_weighted, ini$kernel, start = 1, end = 200, select_p = 0.8)
out = res_sum2$Slist[[200]]
savepath = "/Users/ben/Desktop/work2/GaussianProcess/real_thin/5_nf1000/"
file0 = paste0(savepath ,'test500_11_ini')
output_nii(out,nii,coord,mask1>0,file0,std=TRUE)
saveRDS(res_sum2 ,"/Users/ben/Desktop/work2/GaussianProcess/real_thin/5_nf1000/res_sum2_a05b500_n600_q15.rds")
saveRDS(res ,"/Users/ben/Desktop/work2/GaussianProcess/real_thin/5_nf1000/res_a05b500_n600_q15.rds")
set.seed(2333)
ini = init_bspbss( degree_weighted, mask = (mask1>0), xgrid = coord, dens = 0.5, q = 10, ker_par = c(0.1,500),num_eigen = 500, noise = 0.00 )
saveRDS(ini ,"/Users/ben/Desktop/work2/GaussianProcess/real_thin/5_nf1000/ini_a1b500_n500_q10.rds")
ini = readRDS("/Users/ben/Desktop/work2/GaussianProcess/real_thin/5_nf1000/ini_a1b500_n500_q10.rds")
MClength = 2000
burn_in = 0
show_step = 10
thin0 = 10
res = mcmc_bspbss(degree_weighted,ini$init,ini$prior,ini$kernel,0.5,lr= 0.5,subsample_n = 0.05, subsample_p = 0.005, MClength,burn_in,thin0,show_step)
res_sum2 = sum_mcmc_bspbss(res, degree_weighted, ini$kernel, start = 1, end = 200, select_p = 0.8)
out = res_sum2$Slist[[200]]
savepath = "/Users/ben/Desktop/work2/GaussianProcess/real_thin/5_nf1000/"
file0 = paste0(savepath ,'test500_11_ini')
output_nii(out,nii,coord,mask1>0,file0,std=TRUE)
set.seed(2333)
ini = init_bspbss( degree_weighted, mask = (mask1>0), xgrid = coord, dens = 0.5, q = 10, ker_par = c(0.02,500),num_eigen = 500, noise = 0.00 )
saveRDS(ini ,"/Users/ben/Desktop/work2/GaussianProcess/real_thin/5_nf1000/ini_a02b500_n500_q10.rds")
ini = readRDS("/Users/ben/Desktop/work2/GaussianProcess/real_thin/5_nf1000/ini_a02b500_n500_q10.rds")
MClength = 2000
burn_in = 0
show_step = 10
thin0 = 10
res = mcmc_bspbss(degree_weighted,ini$init,ini$prior,ini$kernel,0.5,lr= 0.5,subsample_n = 0.05, subsample_p = 0.005, MClength,burn_in,thin0,show_step)
res_sum2 = sum_mcmc_bspbss(res, degree_weighted, ini$kernel, start = 1, end = 200, select_p = 0.8)
out = res_sum2$Slist[[200]]
savepath = "/Users/ben/Desktop/work2/GaussianProcess/real_thin/5_nf1000/"
file0 = paste0(savepath ,'test500_11_ini')
output_nii(out,nii,coord,mask1>0,file0,std=TRUE)
saveRDS(res_sum2 ,"/Users/ben/Desktop/work2/GaussianProcess/real_thin/5_nf1000/res_sum_a02b500_n500_q10.rds")
saveRDS(res ,"/Users/ben/Desktop/work2/GaussianProcess/real_thin/5_nf1000/res_a02b500_n500_q10.rds")
res_sum3 = readRDS("/Users/ben/Desktop/work2/GaussianProcess/real_thin/6/res_sum12k_2k_t10_0.5_1_.rds")
savepath = "/Users/ben/Desktop/work2/GaussianProcess/real_thin/6/"
out = res_sum3$S
file0 = paste0(savepath ,'testS_1')
output_nii(out,nii,coord,mask1>0,file0,std=TRUE)
Agp = res_sum3$A[,8]
A1 = Agp[phenotype$DX_GROUP==1] #patient
A2 = Agp[phenotype$DX_GROUP==2] #controls
tmp = t.test(log(-A1),log(-A2) )
tmp$p.value
tmp = wilcox.test(Agp~phenotype$DX_GROUP)
tmp$p.value
res_sum_list=list()
res_sum_list[[1]] = res_sum3
res_sum3 = readRDS("/Users/ben/Desktop/work2/GaussianProcess/real_thin/6/res_sum12k_2k_t10_0.5_2_.rds")
out = res_sum3$S
file0 = paste0(savepath ,'testS_2')
output_nii(out,nii,coord,mask1>0,file0,std=TRUE)
res_sum_list[[2]] =  res_sum3
Agp = res_sum3$A[,8]
A1 = Agp[phenotype$DX_GROUP==1] #patient
A2 = Agp[phenotype$DX_GROUP==2] #controls
tmp = t.test(log(-A1),log(-A2) )
tmp$p.value
tmp = wilcox.test(Agp~phenotype$DX_GROUP)
tmp$p.value
res_sum3 = readRDS("/Users/ben/Desktop/work2/GaussianProcess/real_thin/6/res_sum12k_2k_t10_0.5_3_.rds")
res_sum_list[[3]] = res_sum3
tmp = readRDS("/Users/ben/Desktop/work2/GaussianProcess/real_thin/4_nf1000/res_sum11k_1k_t10_0.5_3_.rds")
plot(tmp$loglik)
max(res_sum3$loglik)
mean((res_sum3$loglik))
mean(tmp$loglik)
res_sum3 = readRDS("/Users/ben/Desktop/work2/GaussianProcess/real_thin/6/res_sum12k_2k_t10_0.5_4_.rds")
res_sum_list[[4]] = res_sum3
for(i in 1:4){
print(mean(res_sum_list[[i]]$loglik))
}
tmp1 = mcmc.list()
tag = 1
for(i in c(1,2,3,4)){
tmp1[[tag]] = as.mcmc(res_sum_list[[tag]]$loglik)
tag = tag + 1
}
gelman.diag(tmp1)
res_sum3 = readRDS("/Users/ben/Desktop/work2/GaussianProcess/real_thin/6/res_sum12k_2k_t10_0.5_5_.rds")
res_sum_list[[5]] = res_sum3
tmp1 = mcmc.list()
tag = 1
for(i in c(1,2,3,4,5)){
tmp1[[tag]] = as.mcmc(res_sum_list[[tag]]$loglik)
tag = tag + 1
}
gelman.diag(tmp1)
plot( res_sum3$loglik )
library(BSPBSS)
library(ica)
library(oro.nifti)
library(neurobase)
library(coda)
load("/Users/ben/Dropbox/abide_3mm.RData")
mask1 = rep(0, nrow(coord))
coord0 = as.matrix(coord)
for(i in 1:nrow(coord)){
mask1[i] = aal_map[coord0[i,][1],coord0[i,][2],coord0[i,][3]]
}
mask0 = array(0,c(61,73,61))
for(i in 1:nrow(coord0)){
mask0[coord0[i,][1],coord0[i,][2],coord0[i,][3]] = 1
}
res_sum_list=list()
for(i in  1:5){
res_sum_list[[i]] = readRDS(paste0("/Users/ben/Desktop/work2/GaussianProcess/real_thin/6/res_sum12k_2k_t10_0.5_",i,"_.rds") )
}
A_list = list()
tag  =  1
for(i in c(1,2,3,4,5)){
res = readRDS(paste0("/Users/ben/Desktop/work2/GaussianProcess/real_thin/6/res12k_2k_t10_0.5_",i,"_.rds") )
A_list[[tag]] = res$A
tag  = tag + 1
}
dim(A_list[[tag]])
dim(A_list[[1]])
ini = readRDS(paste0("/Users/ben/Desktop/work2/GaussianProcess/real_thin/6/ini_a02b500_n500_q10.rds") )
data_path = '/Users/Ben/Dropbox/myself/Kirby21/KKI39_res2standard.nii.gz'
nii = readNIfTI(data_path)
savepath = "/Users/ben/Desktop/work2/GaussianProcess/real_thin/6/"
for(i in 1:5){
out = res_sum_list[[i]]$S
file0 = paste0(savepath ,'sum_res12k_',i)
output_nii(out,nii,coord,mask1>0,file0,std=TRUE)
}
out = ini$init$ICA_S
file0 = paste0(savepath ,'ICA_')
output_nii(out,nii,coord,mask1>0,file0,std=TRUE)
tmp1 = mcmc.list()
tag = 1
for(i in c(1:5)){
tmp1[[tag]] = as.mcmc(t(A_list[[i]][,8,201:1200]) )
tag = tag + 1
}
tmp2 = gelman.diag(tmp1)
apply(tmp2$psrf,2,mean)
tmp1 = mcmc.list()
tag = 1
for(i in c(1,2,3,4,5)){
tmp1[[tag]] = as.mcmc(res_sum_list[[tag]]$loglik)
tag = tag + 1
}
gelman.diag(tmp1)
savepath = "/Users/ben/Desktop/work2/GaussianProcess/real_thin/6/"
for(i in 1:5){
out = -res_sum_list[[i]]$S
file0 = paste0(savepath ,'neg_sum_res12k_',i)
output_nii(out,nii,coord,mask1>0,file0,std=TRUE)
}
savepath = "/Users/ben/Desktop/work2/GaussianProcess/real_thin/6/"
for(i in 1:5){
out = res_sum_list[[i]]$pip
file0 = paste0(savepath ,'pip_sum_res12k_',i)
output_nii(out,nii,coord,mask1>0,file0,std=TRUE)
}
savepath = "/Users/ben/Desktop/work2/GaussianProcess/real_thin/6/"
for(i in 1:5){
out = res_sum_list[[i]]$pip * ( res_sum_list[[i]]$S <=0 )
file0 = paste0(savepath ,'pip_sum_res12k_',i)
output_nii(out,nii,coord,mask1>0,file0,std=TRUE)
}
savepath = "/Users/ben/Desktop/work2/GaussianProcess/real_thin/6/"
for(i in 1:5){
out = (1-res_sum_list[[i]]$pip) * ( res_sum_list[[i]]$S <=0 )
file0 = paste0(savepath ,'pip_sum_res12k_',i)
output_nii(out,nii,coord,mask1>0,file0,std=TRUE)
}
savepath = "/Users/ben/Desktop/work2/GaussianProcess/real_thin/6/"
for(i in 1:5){
out = (res_sum_list[[i]]$pip) * ( res_sum_list[[i]]$S <=0 )
file0 = paste0(savepath ,'pip_sum_res12k_',i)
output_nii(out,nii,coord,mask1>0,file0,std=TRUE)
}
savepath = "/Users/ben/Desktop/work2/GaussianProcess/real_thin/6/"
for(i in 1:5){
out = (-res_sum_list[[i]]$pip) * ( res_sum_list[[i]]$S <=0 )
file0 = paste0(savepath ,'pip_sum_res12k_',i)
output_nii(out,nii,coord,mask1>0,file0,std=TRUE)
}
savepath = "/Users/ben/Desktop/work2/GaussianProcess/real_thin/6/"
for(i in 1:5){
out = res_sum_list[[i]]$pip * ( res_sum_list[[i]]$S <=0 )
file0 = paste0(savepath ,'pip_sum_res12k_',i)
output_nii(out,nii,coord,mask1>0,file0,std=TRUE)
}
S0 = ini$init$ICA_S
S0 = ini$init$ICA_S
out = matrix(1, ncol = ncol(S0), nrow = nrow(S0))
for(i in 1:nrow(S0)){
z = (S0[i,] - mean(S0[i,]) ) / sd(S0[i,])
out[i,] = z * (abs(z) >= 2)
}
file0 = paste0(savepath ,'ICA_z2')
output_nii(out,nii,coord,mask1>0,file0,std=TRUE)
file0 = paste0(savepath ,'ICA_z2_neg')
output_nii(-out,nii,coord,mask1>0,file0,std=TRUE)
file0 = paste0(savepath ,'ICA_z2_neg')
output_nii(-out,nii,coord,mask1>0,file0,std=FALSE)
sum(res_sum_list[[1]]$S[1,]==0)
dim(res_sum_list[[1]]$S)
sum(res_sum_list[[1]]$S[2,]==0)
sum(res_sum_list[[1]]$S[3,]==0)
sum(res_sum_list[[1]]$S[4,]==0)
sum(res_sum_list[[1]]$S[5,]==0)
sum(res_sum_list[[1]]$S[6,]==0)
sum(res_sum_list[[1]]$S[7,]==0)
sum(res_sum_list[[1]]$S[8,]==0)
sum(res_sum_list[[1]]$S[9,]==0)
sum(res_sum_list[[1]]$S[10,]==0)
dim(res_sum_list[[1]]$A)
Agp = res_sum_list[[1]]$A[,3]
A1 = Agp[phenotype$DX_GROUP==1] #patient
A2 = Agp[phenotype$DX_GROUP==2] #controls
tmp = t.test(log(-A1),log(-A2) )
tmp$p.value
Agp = res_sum_list[[1]]$A[,8]
A1 = Agp[phenotype$DX_GROUP==1] #patient
A2 = Agp[phenotype$DX_GROUP==2] #controls
tmp = t.test(log(-A1),log(-A2) )
tmp$p.value
tmp = wilcox.test(Agp~phenotype$DX_GROUP)
tmp$p.value
